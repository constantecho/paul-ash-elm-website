---
import Layout from '../layouts/Layout.astro';
import { SITE_DATA } from '../consts';
---

<Layout
	title="Contact Us"
	description="Get a free quote for your carpentry project in Virden, Manitoba and surrounding areas."
>
	<div class="contact-intro">
		<h1>Get Your Free Quote</h1>
		<p>
			Ready to start your carpentry project? Contact {SITE_DATA.name} for a free consultation and detailed quote. We serve {SITE_DATA.serviceArea.join(', ')} with professional finish carpentry and home improvement services.
		</p>
	</div>

	<div class="contact-methods-section">
		<h2>Contact Information</h2>

		<div class="contact-grid">
			<div class="contact-card">
				<h3>üìû Call Us</h3>
				<p><a href={`tel:${SITE_DATA.phone.raw}`}>{SITE_DATA.phone.display}</a></p>
				<p class="contact-note">Call for immediate assistance or urgent quotes</p>
			</div>

			<div class="contact-card">
				<h3>‚úâÔ∏è Email Us</h3>
				<p><a href={`mailto:${SITE_DATA.email}`}>{SITE_DATA.email}</a></p>
				<p class="contact-note">Best for detailed project descriptions and photos</p>
			</div>

			<div class="contact-card">
				<h3>üìç Service Area</h3>
				<p>{SITE_DATA.serviceArea.join(' ‚Ä¢ ')}</p>
				<p class="contact-note">Serving {SITE_DATA.address.city}, {SITE_DATA.address.province} and surrounding areas</p>
			</div>

			<div class="contact-card">
				<h3>üõ°Ô∏è Business Details</h3>
				<p>GST: {SITE_DATA.gst}</p>
				<p>Fully Insured ‚Ä¢ Owner-Operated</p>
				<p class="contact-note">Payment: {SITE_DATA.paymentMethods.join(', ')}</p>
			</div>
		</div>
	</div>

	<div class="contact-form-section" id="quote">
		<h2>Request Your Free Quote</h2>

		<form id="contactForm" action={`mailto:${SITE_DATA.email}`} method="get">
			<!-- Honeypot field to prevent spam -->
			<div class="form-group" style="display:none">
				<label for="_gotcha">Leave this field empty if you're human</label>
				<input type="text" name="_gotcha" id="_gotcha" tabindex="-1" autocomplete="off">
			</div>

			<div id="form-status" class="form-status" style="display:none"></div>
			<div class="form-row">
				<div class="form-group">
					<label for="name">Name*</label>
					<input type="text" id="name" name="name" required minlength="2" maxlength="100">
				</div>

				<div class="form-group">
					<label for="phone">Phone*</label>
					<input type="tel" id="phone" name="phone" required>
				</div>
			</div>

			<div class="form-row">
				<div class="form-group">
					<label for="email">Email</label>
					<input type="email" id="email" name="email" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$">
				</div>

				<div class="form-group">
					<label for="location">Project Location</label>
					<input type="text" id="location" name="location" placeholder="City or general area">
				</div>
			</div>

			<div class="form-group">
				<label>Type of Project:</label>
				<div class="service-tags">
					<div class="service-tag" data-value="finish-carpentry">Finish Carpentry</div>
					<div class="service-tag" data-value="doors-hardware">Doors & Hardware</div>
					<div class="service-tag" data-value="custom-shelving">Custom Shelving</div>
					<div class="service-tag" data-value="deck-fence">Deck/Fence Repair</div>
					<div class="service-tag" data-value="renovation">Small Renovation</div>
					<div class="service-tag" data-value="flooring">Flooring Repairs</div>
					<div class="service-tag" data-value="other">Other</div>
				</div>
				<input type="hidden" id="service-type" name="service-type" value="">
			</div>

			<div class="form-row">
				<div class="form-group">
					<label for="timeline">Desired Timeline</label>
					<select id="timeline" name="timeline">
						<option value="">Select timeline</option>
						<option value="asap">As soon as possible</option>
						<option value="1-2weeks">1-2 weeks</option>
						<option value="1month">Within a month</option>
						<option value="flexible">Flexible</option>
					</select>
				</div>

				<div class="form-group">
					<label for="budget">Approximate Budget</label>
					<select id="budget" name="budget">
						<option value="">Select budget range</option>
						<option value="under-500">Under $500</option>
						<option value="500-1500">$500 - $1,500</option>
						<option value="1500-5000">$1,500 - $5,000</option>
						<option value="over-5000">Over $5,000</option>
						<option value="unsure">Not sure</option>
					</select>
				</div>
			</div>

			<div class="form-group">
				<label for="message">Project Description*</label>
				<textarea id="message" name="message" rows="6" required placeholder="Please describe your project in detail. Include dimensions, materials preferences, and any specific requirements."></textarea>
			</div>

			<div class="form-group checkbox-group">
				<input type="checkbox" id="consultation" name="consultation" value="yes" checked>
				<label for="consultation">I would like a free on-site consultation</label>
			</div>

			<button type="submit" class="cta-button">Send Quote Request</button>
		</form>
	</div>

	<div class="business-info-section">
		<h2>Why Choose {SITE_DATA.name}?</h2>

		<div class="info-grid">
			<div class="info-item">
				<h3>‚úÖ Owner-Operated</h3>
				<p>Work directly with the craftsman. Clear communication and personal accountability on every project.</p>
			</div>

			<div class="info-item">
				<h3>üõ°Ô∏è Fully Insured</h3>
				<p>Your property and project are protected with comprehensive liability insurance.</p>
			</div>

			<div class="info-item">
				<h3>‚è∞ Reliable Service</h3>
				<p>On-time arrival and completion. We respect your schedule and keep our commitments.</p>
			</div>

			<div class="info-item">
				<h3>üè† Local Expertise</h3>
				<p>Familiar with local building codes and suppliers. Serving {SITE_DATA.serviceArea.join(', ')} with pride.</p>
			</div>
		</div>
	</div>

	<div class="faq-section">
		<h2>Frequently Asked Questions</h2>

		<div class="faq-container">
			<div class="faq-item">
				<div class="faq-question">Do you provide free quotes?</div>
				<div class="faq-answer">
					<p>Yes! All quotes are completely free with no obligation. We'll visit your project site, discuss your needs, and provide a detailed written estimate.</p>
				</div>
			</div>

			<div class="faq-item">
				<div class="faq-question">How quickly can you start my project?</div>
				<div class="faq-answer">
					<p>Timeline depends on project size and current schedule. Smaller projects can often start within 1-2 weeks, while larger renovations may require more planning time. We'll provide a realistic timeline with your quote.</p>
				</div>
			</div>

			<div class="faq-item">
				<div class="faq-question">What payment methods do you accept?</div>
				<div class="faq-answer">
					<p>We accept {SITE_DATA.paymentMethods.join(', ')}. Payment schedules are typically arranged as deposit + progress payments + final payment upon completion.</p>
				</div>
			</div>

			<div class="faq-item">
				<div class="faq-question">Do you provide materials or should I purchase them?</div>
				<div class="faq-answer">
					<p>We can handle material procurement for your convenience, or work with materials you've purchased. We'll discuss the best approach based on your project and preferences during the consultation.</p>
				</div>
			</div>

			<div class="faq-item">
				<div class="faq-question">Are you licensed and insured?</div>
				<div class="faq-answer">
					<p>Yes, we are fully insured with comprehensive liability coverage. GST registration: {SITE_DATA.gst}. We follow all local building codes and best practices.</p>
				</div>
			</div>
		</div>
	</div>
</Layout>

<style>
	.contact-intro {
		max-width: 800px;
		margin: 0 auto 4rem;
		text-align: center;
	}

	.contact-intro p {
		font-size: 1.2rem;
		line-height: 1.6;
	}
	
	.contact-methods-section,
	.contact-form-section,
	.business-info-section,
	.faq-section {
		margin: 5rem 0;
	}

	.contact-grid {
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: 2rem;
		margin: 2rem 0;
	}

	.contact-card {
		background-color: white;
		padding: 2rem;
		border-radius: 8px;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
		text-align: center;
		border-left: 4px solid var(--green-700);
	}

	.contact-card h3 {
		color: var(--green-700);
		margin-bottom: 1rem;
		font-size: 1.2rem;
	}

	.contact-card a {
		font-weight: 600;
		color: var(--green-700);
		font-size: 1.1rem;
	}

	.contact-note {
		font-size: 0.9rem;
		color: rgb(var(--gray));
		margin-top: 0.5rem;
	}

	.service-tags {
		display: flex;
		flex-wrap: wrap;
		gap: 0.5rem;
		margin-bottom: 0.5rem;
	}

	.service-tag {
		display: inline-block;
		padding: 0.5rem 1rem;
		border-radius: 20px;
		font-size: 0.9rem;
		margin-bottom: 0.5rem;
		background-color: rgba(var(--gray-light), 0.7);
		cursor: pointer;
		transition: all 0.2s ease;
		border: 2px solid transparent;
	}

	.service-tag:hover,
	.service-tag.selected {
		background-color: rgba(var(--green-700), 0.1);
		color: var(--green-700);
		border-color: var(--green-700);
	}
	
	.form-row {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: 1.5rem;
		margin-bottom: 1.5rem;
	}
	
	.form-group {
		margin-bottom: 1.5rem;
	}
	
	label {
		display: block;
		margin-bottom: 0.5rem;
		font-weight: 500;
	}
	
	input[type="text"],
	input[type="email"],
	input[type="tel"],
	textarea,
	select {
		width: 100%;
		padding: 0.75rem;
		border: 1px solid rgba(var(--gray), 0.3);
		border-radius: 4px;
		font-family: inherit;
		font-size: 1rem;
	}
	
	input:focus,
	textarea:focus,
	select:focus {
		outline: none;
		border-color: var(--primary);
		box-shadow: 0 0 0 2px rgba(58, 92, 201, 0.2);
	}
	
	.checkbox-group {
		display: flex;
		align-items: center;
		gap: 0.5rem;
	}
	
	.checkbox-group input {
		width: auto;
	}
	
	.checkbox-group label {
		margin-bottom: 0;
		font-weight: normal;
	}
	
	.form-status {
		margin-bottom: 1.5rem;
		padding: 1rem;
		border-radius: 4px;
	}
	
	.form-status .success-message {
		background-color: rgba(0, 180, 0, 0.1);
		color: rgb(0, 120, 0);
		padding: 1rem;
		border-radius: 4px;
		border-left: 4px solid rgb(0, 120, 0);
	}
	
	.form-status .error-message {
		background-color: rgba(220, 0, 0, 0.1);
		color: rgb(180, 0, 0);
		padding: 1rem;
		border-radius: 4px;
		border-left: 4px solid rgb(180, 0, 0);
	}
	
	.interest-tags {
		display: flex;
		flex-wrap: wrap;
		gap: 0.5rem;
		margin-bottom: 0.5rem;
	}
	
	.info-grid {
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: 2rem;
	}
	
	.info-item {
		padding: 1.5rem;
		background-color: white;
		border-radius: 8px;
		box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
	}
	
	.info-item h3 {
		color: var(--primary);
		margin-bottom: 1rem;
	}
	
	.social-links {
		display: flex;
		gap: 1rem;
	}
	
	.social-links a {
		display: inline-block;
		padding: 0.5rem 1rem;
		background-color: rgba(var(--gray-light), 0.7);
		border-radius: 4px;
		transition: background-color 0.2s ease;
	}
	
	.social-links a:hover {
		background-color: rgba(var(--gray-light), 1);
		text-decoration: none;
	}
	
	.faq-container {
		max-width: 900px;
		margin: 0 auto;
	}
	
	@media (max-width: 768px) {
		.contact-grid {
			grid-template-columns: 1fr;
		}

		.contact-card {
			padding: 1.5rem;
		}

		.form-row {
			grid-template-columns: 1fr;
			gap: 0;
		}

		.info-grid {
			grid-template-columns: 1fr;
		}

		.service-tags {
			justify-content: center;
		}

		.service-tag {
			font-size: 0.8rem;
			padding: 0.4rem 0.8rem;
		}
	}
</style>

<script>
	// Carpentry form handling
	document.addEventListener('DOMContentLoaded', function() {
		// Service tag selection
		document.querySelectorAll('.service-tag').forEach(function(tag) {
			tag.addEventListener('click', function() {
				// Remove selection from all tags
				document.querySelectorAll('.service-tag').forEach(t => {
					t.classList.remove('selected');
				});

				// Add selection to clicked tag
				this.classList.add('selected');

				// Update hidden input
				const serviceType = this.getAttribute('data-value');
				document.getElementById('service-type').value = serviceType;
			});
		});

		// Form submission handling with mailto fallback
		document.getElementById('contactForm').addEventListener('submit', function(e) {
			e.preventDefault();

			// Get form data
			const formData = new FormData(this);

			// Build email subject and body
			const name = formData.get('name') || '';
			const phone = formData.get('phone') || '';
			const email = formData.get('email') || '';
			const location = formData.get('location') || '';
			const serviceType = formData.get('service-type') || '';
			const timeline = formData.get('timeline') || '';
			const budget = formData.get('budget') || '';
			const message = formData.get('message') || '';
			const consultation = formData.get('consultation') || '';

			const subject = `Quote Request from ${name}`;
			const body = `
Name: ${name}
Phone: ${phone}
Email: ${email}
Location: ${location}
Service Type: ${serviceType}
Timeline: ${timeline}
Budget: ${budget}
Consultation Requested: ${consultation ? 'Yes' : 'No'}

Project Description:
${message}

---
Sent via ash-elm.ca contact form
			`.trim();

			// Create mailto URL
			const mailtoUrl = `mailto:${this.action.replace('mailto:', '')}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;

			// Open email client
			window.location.href = mailtoUrl;

			// Show success message
			const statusDiv = document.getElementById('form-status');
			statusDiv.innerHTML = '<div class="success-message">Your email client should open with the quote request. If it doesn\'t, please copy the details and send to ' + this.action.replace('mailto:', '') + '</div>';
			statusDiv.style.display = 'block';
			statusDiv.scrollIntoView({behavior: 'smooth', block: 'center'});
		});

		// FAQ accordion functionality
		document.querySelectorAll('.faq-question').forEach(function(question) {
			question.addEventListener('click', function() {
				const faqItem = this.parentElement;
				faqItem.classList.toggle('active');
			});
		});
	});
</script>